<html>
<head>
	<title>Poker</title>
	<!--meta name="viewport" content="width=device-width,initial-scale=1.0"-->
	<meta charset="UTF-8">
	<link rel="icon" href="trophyicon.png">
	<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@800&display=swap" rel="stylesheet">
	<style>
		body {
			text-align:center;
			font-family:'Tahoma', Verdana, sans-serif;
			overflow:auto;
			margin-left:0px;
			margin-right:0px;
			background-color:#bb8833;
		}
		#pot {
			font-size:15pt;
			font-weight:bold;
			background-color:#008800;
			color:white;
			padding:5px;
			border-radius:5px;
			border:2px solid white;
			margin-top:2px;
			display:inline-block;
		}
		.playerCards {
			width:100%;
			height:100px;
			display:inline-block;
			transform: scale(1.4);
		}
		#player2, #player3 {
			text-align:center;
			margin:5px 90px 15px 90px;
		}
		#player2 .playerCards, #player3 .playerCards {
			transform: scale(1.4) translateY(18px);
		}
		#player0, #player5 {
			text-align:center;
			margin:140px 90px 5px 90px;
		}
		#player0 .playerCards, #player5 .playerCards {
			transform: scale(1.4) translateY(-17px);
		}
		#player1 {
			text-align:left;
			margin:20px 20px 15px 5px;
		}
		#player1 .playerCards {
			transform: scale(1.4) translateX(47px) translateY(18px);
		}
		#player4 {
			text-align:right;
			margin:20px 5px 15px 20px;
		}
		#player4 .playerCards {
			transform: scale(1.4) translateX(-47px) translateY(18px);
		}
		.playerArea {
			width:26%;
			display:inline-block;
			vertical-align:middle;
		}

		.playerInfo {
			width:100%;
			display:inline-block;
		}
		/*#fullScreen {
			color:blue;
			cursor:pointer;
		}*/
		#playTableContainer {
			width:100%;
			display:inline-block;
			/*padding-left:30px;
			padding-right:30px;*/
		}
		#playTableContainer>div {
			width:100%;
			display:inline-block;
			/*padding-left:30px;
			padding-right:30px;*/
		}
		#playTable {
			width:100%;
			border-collapse:collapse;
			table-layout:fixed;
			margin-top:400px;
		}
		.dealerLabel {
			display:none;
			font-weight:bold;
			position:relative;
			height:1.5em;
			z-index:104;
			margin-bottom:-1.5em;
			margin-top:0px;
			transform:translateY(-105px);
		}
		.dealerLabel span {
			color:white;
			border:5px solid #0000bb;
			border-radius:5px;
			background-color:#0000bb;
		}
		.card, .invisibleCard {
			font-family:'Roboto Slab', Tahoma, sans-serif;
			border:1px solid black;
			border-radius:6px;
			background-color:white;
			font-size:30pt;
			font-weight:bolder;
			text-align:center;
			line-height:75%;
			letter-spacing:-3;
			height:1.6em;
			display:inline-block;
		}
		.playerCards .card {
			width:96%;
			padding:2px 2px 2px 0px;
		}
		#centerCardsContainer {
			width:42%;
			display:inline-block;
			transform:scale(1.35) translateY(52px);
			vertical-align:middle;
		}
		#centerCardsContainer .card {
			width:46px;
			vertical-align:middle;
			border-width:2px;
			padding:2px;
		}
		#centerCardsContainer .card.empty {
    		border:2px dashed white;
    		background-color:transparent;
		}
		#centerCardsContainer .card.empty:hover {
    		background-color:#bbbbff;
    		cursor:pointer;
		}
		.invisibleCard {
			width:1px;
			opacity:0;
			padding-right:0px;
			padding-left:0px;
		}
		.cardContainer {
			width:12%;
			padding-right:3px;
			display:inline-block;
			text-align:center;
			min-height:103px;
			vertical-align:top;
		}
		.cardHandIndex {
			font-family:'Tahoma', Verdana, sans-serif;
			font-size:14pt;
			border:1px solid black;
			border-radius:22px;
			margin-top:2px;
			margin-bottom:2px;
			padding-left:6px;
			padding-right:6px;
			display:inline-block;
			background-color:#000066;
			color:white;
		}
		.controlPanel {
			display:inline-block;
			width:11%;
			vertical-align:middle;
		}
		.controlPanel button {
			width:100%;
			border-radius:8px;
			border:2px solid white;
			background-color:red;
			font-size:14pt;
			font-weight:bold;
			margin-top:2px;
			padding:6px 2px 6px 2px;
		}
		.controlPanel button:hover {
			cursor:pointer;
			background-color:#9999ff !important;
			color:black !important;
		}
		#playTable tr td {
			/*padding-bottom:8px;*/
		}
		.red {
			color:red;
		}
		.black {
			color:black;
		}
		.suit {
			width:100%;
			font-size:40pt;
		}
		.facedown {
			background-repeat:no-repeat;
			background-size:contain;
			background-position:center;
			background-image:url('cardBackBicycle.gif');
			background-color:#dddddd;/*#252760;*/
		}
		.playerInfoWrapper {
			max-width:80px;
		}
		.playerInfo img {
			background-color:white;
			border-radius:8px;
			border:3px solid black;
			max-height:100px;
			position:relative;
		}
		.playerName {
			margin-top:0px;
			margin-bottom:0px;
    		font-size:11pt;
			position:relative;
			z-index:100;
		}
		.playerName span {
			color:black;
			border-radius:4px;
			background-color:#ccccff;
			border:2px solid #000088;
			padding-left:2px;
			padding-right:2px;
			display:inline-block;
			margin-top:-1.6em;
			margin-bottom:-1.3em;
			min-height:1.3em;
			min-width:1.3em;
		}
    	.playerCards table {
    		width:100%;
    		/*table-layout:fixed;*/
    	}
    	.playerCards .card:hover {
    		background-color:#ffbb99 !important;
    		cursor:pointer;
    	}
    	.selectedCard .card, .selectedCard .cardHandIndex {
    		background-color:#ffbb99 !important;
			background-image:none !important;
    	}
    	.selectedCard .cardHandIndex {
    		color: black;
    	}
    	.playerInfo.right {
    		text-align:right;
    	}
    	.playerInfo.left {
    		text-align:left;
    	}
    	.playerInfoWrapper br {
			display:none;
    	}
		</style>
	<script src="jquery.js"></script>
</head>
<body style="overflow-y:scroll;text-align:center;">
	<!--img id="bgPhoto" src="LivingRoomBackground.jpg" style="width:100%;position:absolute;left:0px;top:0px;z-index:-1"-->
	<div id="playTableContainer">
		<div>
			<div id="player2" class="playerArea">
				<div class="playerInfo"></div>
				<div class="playerCards"></div>
			</div>
			<div id="player3" class="playerArea">
				<div class="playerInfo"></div>
				<div class="playerCards"></div>
			</div>
		</div>
		<div>
			<div id="player1" class="playerArea">
				<div class="playerInfo"></div>
				<div class="playerCards"></div>
			</div>
			<div id="centerCardsContainer">
				<span class="card" id="centerCard3" onclick="DealCenterCard(3)"></span><br>
				<span class="card" id="centerCard0" onclick="DealCenterCard(0)"></span>
				<span class="card" id="centerCard1" onclick="DealCenterCard(1)"></span>
				<span class="card" id="centerCard2" onclick="DealCenterCard(2)"></span><br>
				<span class="card" id="centerCard4" onclick="DealCenterCard(4)"></span><br>
				<span id="pot">$0.00</span>
			</div>
			<div id="player4" class="playerArea">
				<div class="playerInfo"></div>
				<div class="playerCards"></div>
			</div>
		</div>
		<div>
			<div class="controlPanel">
				<br><br><br><br><br>
				<button style="background-color:white;color:red" onclick="DealNextUpCard()">Deal Face Up</button><br><br>
				<input type="text" id="faceDownCount" style="width:25%;font-size:15pt;text-align:center;font-weight:bold;">
				<button style="background-color:#000066;color:white;width:70%;" onclick="DealFaceDown()">Face Down</button><br><br><br>
				<button style="background-color:#008800;color:white">Collect $$$</button><br><br><br>
				<button style="background-color:red" onclick="NewHand()">New Hand</button>
			</div>
			<div id="player0" class="playerArea">
				<div class="playerCards"></div>
				<div class="playerInfo"></div>
			</div>
			<div id="player5" class="playerArea">
				<div class="playerCards"></div>
				<div class="playerInfo"></div>
			</div>
			<div class="controlPanel">
				<button style="background-color:#cc88ff" onclick="ToggleCenterCards()">Cards in Middle</button><br>
				<button style="background-color:#ffcc88" onclick="ToggleFullScreen()">Full Screen</button><br>
				<button style="background-color:#88ffcc" onclick="FlipSelectedCards()">Flip Over Card(s)</button><br>
				<button style="background-color:#cccccc" onclick="SelectAllFacedown()">Select All Facedown</button><br>
				<button style="background-color:#888888" onclick="SelectAll()">Select All</button><br>
				<button style="background-color:#000000;color:white;" onclick="Deselect()">De-Select All</button><br>
			</div>
		</div>
	</div>
</body>
<script>
	var DECK = [];
	var NAMES = [
		"Ray",
		"Jeff",
		"Nicholas",
		"Angela",
		"David",
		"Michael"
	];

	var PLAYERS = [];
	var TOTAL_SEATS = 6;
	var SEATS = [];
	var DEALER = null;
	var CURRENT_SEAT = null;
	var START_SEAT = null;
	var END_SEAT = null;
	var DEALER_SEAT = 0;

	var IS_FULLSCREEN = false;

	var SUITS = ["♥", "♠", "♦", "♣"];
	var VALS = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

	var SHOW_SCORES = true; // (Math.random() > 0.5);	
	var SHOW_NAMES = false; //(Math.random() > 0.5);
	var PREV_SHOW_SCORES = SHOW_SCORES;

	var GAMES = [
		[0,0,0,0,0],
		[0,0,1,1,1,0,0],
		[0,0,1,1,1,1,0],
		[0,0,0,0],
		[0,0],
		[0,1,1,1,0],
		[0,1,1,1,1],
		[1,1,1,1,1]
	];

	DECK = [];
	DECK_INDEX = 0;

	var totalMoney = 0;
	CURRENT_SEAT = 0;
	var GAME_CHOICE = Math.floor(Math.random() * GAMES.length);

	for (var i = 0; i < PLAYERS.length; i++) {
		var money = (7 + (0.05 * Math.floor(Math.random() * 120)));
		if (i >= (PLAYERS.length - 1)) {
			money = (10 * PLAYERS.length) - totalMoney;
		}
		totalMoney += money;
		var playerDiv = $("#player" + i);
		var span = $("<span></span>");
		span.addClass("playerInfoWrapper");
		var img = $("<img>");
		img.attr("src", "players/" + NAMES[i] + ".jpg");
		span.append(img);
		var label = $("<p></p>");
		label.addClass("playerName");
		label.html("<span>" + NAMES[i] + " <strong>$" + money.toFixed(2) + "</strong></span>");
		span.append(label);
		playerDiv.find(".playerInfo").append(span);
		$("#player" + i).find(".playerCards").append("<span class='invisibleCard'></span>");
	}

	// Load the images now so they're ready to display when user clicks Play Golf!
	for (var i = 0; i < NAMES.length; i++) {
		var img = $("<img>");
		img.attr("nameIndex", i);
		img.attr("src", "players/" + NAMES[i] + ".jpg");
		img.attr("onclick", "ClickedPlayer(this)");
		$("#playerPhotos").append(img);
	}

	Setup();
	NewHand();

	function NewHand() {
		DEALER_SEAT = ((DEALER_SEAT + 1) % PLAYERS.length);
		$(".playerInfoWrapper img").css("border", "").css("margin", "");
		$(".dealerLabel").hide();
		$("#player" + DEALER_SEAT + " img").css("border", "10px solid #0000bb").css("margin", "-7px -7px -7px -7px");
		$("#player" + DEALER_SEAT + " .dealerLabel").show();

		CURRENT_SEAT = DEALER_SEAT;
		AdvanceCurrentPlayer();

		for (var i = 0; i < PLAYERS.length; i++) {
			PLAYERS[i].folded = false;
			PLAYERS[i].cards = [];
		}

		$("#centerCardsContainer span.card").addClass("empty").removeClass("facedown").html("");
		$(".facedown").removeClass("facedown");
		$(".playerCards .card").remove();
		$(".playerCards .cardContainer").remove();
		DECK = [];
		DECK_INDEX = 0;
		for (var i = 1; i <= 52; i++) {
			DECK.push(-i);
		}
		for (var i = 0; i < 52; i++) {
			var randNum = i + Math.floor(Math.random() * (52 - i));
			var temp = DECK[i];
			DECK[i] = DECK[randNum];
			DECK[randNum] = temp;
		}
	}

	function DealFaceDown() {
		var numberOfCards = parseInt($("#faceDownCount").val());
		$("#faceDownCount").val(null);
		if (isNaN(numberOfCards)) {
			return;
		}

		var cardsDealt = 0;
		for (var r = 0; r < numberOfCards; r++) {
			for (var i = 1; i <= PLAYERS.length; i++) {
				var seat = (DEALER_SEAT + i) % PLAYERS.length;
				if (PLAYERS[seat].folded || DECK_INDEX >= 52) {
					continue;
				}

				var cardVal = DECK[DECK_INDEX++];
				PLAYERS[seat].cards.push(cardVal);
				setTimeout(RenderDealCard, 170 * cardsDealt++, seat, cardVal);
			}
		}
	}

	function FlipSelectedCards() {
		$(".selectedCard").each(function() {
			//$(this).removeClass("selectedCard");
			var cardEl = $(this).find(".card");
			var currVal = parseInt(cardEl.attr("cardVal"));
			cardEl.attr("cardVal", -currVal);
			RenderCard(cardEl, -currVal);
		});
	}

	function SelectAll() {
		$(".cardContainer").addClass("selectedCard");
	}

	function SelectAllFacedown() {
		$(".facedown").parent().addClass("selectedCard");
	}

	function Deselect() {
		$(".selectedCard").removeClass("selectedCard");
	}

	function DealNextUpCard() {
		var cardVal = Math.abs(DECK[DECK_INDEX++]);
		PLAYERS[CURRENT_SEAT].cards.push(cardVal);
		RenderDealCard(CURRENT_SEAT, cardVal);
		AdvanceCurrentPlayer();
	}

	function DealCenterCard(pIndex) {
		var cardVal = Math.abs(DECK[DECK_INDEX++]);
		RenderCard($("#centerCard" + pIndex), cardVal);
		$("#centerCard" + pIndex).removeClass("empty");
	}

	function RenderDealCard(pSeatNum, pCardVal) {
		var playerCards = $("#player" + pSeatNum).find(".playerCards");
		var cardIndex = playerCards.find(".card").length;

		var cardContainer = $("<span class='cardContainer'></span>")
		var index = $("<span class='cardHandIndex'>" + (cardIndex + 1) + "</span>");
		var card = $("<span class='card'></span>");
		card.attr("onclick", "SelectCard(this," + pSeatNum + "," + cardIndex + ")");
		card.attr("cardVal", pCardVal);

		if (pSeatNum === 0 || pSeatNum === 5) {
			cardContainer.append(index).append("<br>").append(card);
		} else {
			//cardContainer.append(index).append("<br>").append(card);
			cardContainer.append(card).append("<br>").append(index);
		}

		playerCards.append(cardContainer);
		RenderCard(card, pCardVal);
	}

	function RenderCard(td, value) {
		td.attr("cardVal", value);
		td.removeClass("red").removeClass("black").removeClass("facedown").removeClass("faceup");
		var isFaceDown = (value < 0);
		value = Math.abs(value);

		if (isFaceDown) {
			td.addClass("facedown");
			td.html("");
		}
		else {
			cardVal = value - 1;
			td.addClass("faceup");
			var suit = Math.floor(cardVal / 13);
			td.html("<span>" + VALS[cardVal % 13] + "</span><br>" + '<span class="suit">' + SUITS[suit] + '</span>')
			  .addClass(suit % 2 == 1 ? "black" : "red");
		}
	}

	function SelectCard(pCardEl, pSeatNum, pCardIndex) {
		console.log("Seat " + pSeatNum + ", Card " + pCardIndex);
		var container = $(pCardEl).parent();
		if (container.hasClass("selectedCard")) {
			container.removeClass("selectedCard");
		}
		else {
			container.addClass("selectedCard");
		}
	}

	function AdvanceCurrentPlayer() {
		var started = true;
		while (started === true || PLAYERS[CURRENT_SEAT].folded) {
			started = false;
			CURRENT_SEAT += 1;
			CURRENT_SEAT %= PLAYERS.length;
		}
	}

	function Setup() {
		if (PLAYERS.length > 0) {
			return;
		}

		for (var i = 0; i < NAMES.length; i++) {
			PLAYERS.push({
				name: NAMES[i],
				money: (10).toFixed(2),
				folded: false,
				cards: []
			});
		}

		$(".playerInfo").each(function() {
			var span = $("<span></span>");
			span.addClass("playerInfoWrapper");
			var name = $("<p><span></span></p>");
			name.addClass("playerName");
			var img = $("<img>");
			var dealer = $("<p><span>DEALER</span></p>");
			dealer.addClass("dealerLabel");
			span.append(img);
			span.append(dealer);
			span.append(name);
			$(this).append(span);
		});

		for (var i = 0; i < PLAYERS.length; i++) {
			var label = $("#player" + i).find(".playerName span");
			label.html(GetPlayerLabelText(i));
		}

		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (i >= PLAYERS.length) {
				$("#player" + i).hide();
			}
			else {
				$("#player" + i + " img").show().attr("src", "players/" + PLAYERS[i].name + ".jpg");
				$("#player" + i + " .playerName").show();
			}
		}

		ToggleCenterCards();
	}

	function UpdateScore(pSeatNum) {
		SEATS[pSeatNum].scores[ROUND_NUM - 1] = GetSeatScore(pSeatNum);
		var labelEl = $("#playerInfo" + pSeatNum).find(".playerName span");
		$.when(labelEl.fadeOut(200)).then(function() {
			setTimeout(function() {
				labelEl.html(GetPlayerLabelText(pSeatNum)).css("background-color", "#ffaaaa").css("border-color", "red");
				labelEl.fadeIn(200);
			}, 1);
		});
	}

	function ToggleNames() {
		SHOW_NAMES = !SHOW_NAMES;
		ShowHideNames();
	}

	function ToggleScores() {
		SHOW_SCORES = !SHOW_SCORES;
		ShowHideNames();
	}

	function ToggleCenterCards() {
		$("#centerCardsContainer .card, #centerCardsContainer br").toggle();
	}

	function ShowHideNames() {
		$(".playerName").toggle(SHOW_SCORES || SHOW_NAMES);

		for (var i = 0; i < SEATS.length; i++) {
			var label = $("#playerInfo" + i).find(".playerName span");
			if (SEATS[i] === null) {
				label.hide();
			}
			else {
				label.html(GetPlayerLabelText(i));
			}
		}
	}

	function GetPlayerLabelText(pSeatNum) {
		return (SHOW_NAMES ? PLAYERS[pSeatNum].name : "") + (SHOW_SCORES ? " <strong>$" + PLAYERS[pSeatNum].money + "</strong>" : "");
	}

	function ToggleFullScreen() {
	/*	var body = $("body")[0];
		if (body.requestFullscreen) {
			body.requestFullscreen();
		} else if (body.webkitRequestFullscreen) { // Safari 
			body.webkitRequestFullscreen();
		} else if (elem.msRequestFullscreen) { // IE11
			body.msRequestFullscreen();
		}*/

		if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {  // current working methods
			if (document.documentElement.requestFullscreen) {
				document.documentElement.requestFullscreen();
			} else if (document.body.msRequestFullscreen) {
				document.body.msRequestFullscreen();
			} else if (document.documentElement.msRequestFullscreen) {
				document.documentElement.msRequestFullscreen();
			} else if (document.documentElement.mozRequestFullScreen) {
				document.documentElement.mozRequestFullScreen();
			} else if (document.documentElement.webkitRequestFullscreen) {
				document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
			}
		} else {
			if (document.exitFullscreen) {
				document.exitFullscreen();
			} else if (document.msExitFullscreen) {
				document.msExitFullscreen();
			} else if (document.mozCancelFullScreen) {
				document.mozCancelFullScreen();
			} else if (document.webkitExitFullscreen) {
				document.webkitExitFullscreen();
			}
		}
	}
</script>

</html>