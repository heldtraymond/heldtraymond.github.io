<html>
<head>
	<title>Golf</title>
	<!--meta name="viewport" content="width=device-width,initial-scale=1.0"-->
	<meta charset="UTF-8">
	<link rel="icon" href="https://heldtraymond.github.io/Golf/trophyicon.png">
	<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@800&display=swap" rel="stylesheet">
	<style>
		body {
			text-align:center;
			font-family:'Tahoma', Verdana, sans-serif;
			overflow:auto;
			margin-left:0px;
			margin-right:0px;
		}
		#continuePlaying {
			background-color:#ccccff;
			border:3px solid #000099;
			border-radius:6px;
			padding:4px;
			font-size:14pt;
			display:inline-block;
		}
		#continuePlaying img {
			max-height:70px;
			padding:3px;
		}
		#continuePlayingButton {
			background-color:#008800;
			color:#ffffff;
		}
		#continuePlayingButton:hover {
			background-color:#99ff99;
			color:#008800;
		}
		#changePlayingButton {
			background-color:#ff8888;
			color:#000000;
			padding:4px;
			font-size:12pt;
		}
		#changePlayingButton:hover {
			background-color:#ff0000;
		}
		/*#fullScreen {
			color:blue;
			cursor:pointer;
		}*/
		.deviceDescription {
			text-align:center;
			vertical-align:top;
			font-family:Tahoma, sans-serif;
			font-size:14pt;
		}
		#mobileDescription {
			text-align:center;
			font-family:Tahoma, sans-serif;
			font-size:14pt;
			margin-top:13px;
			display:inline-block;
			max-width:750px;
		}
		#howToPlay {
			font-family:'Roboto Slab', Tahoma, sans-serif;
			font-size:30pt;
			display:inline-block;
			text-align:center;
			margin-left:-2%;
		}
		.howToPlayHalf {
			width:46%;
			margin: 0% 1% 1% 1%;
			display:inline-block;
			vertical-align:top;
		}
		.howToPlaySubsection {
			border:4px solid #006600;
			border-radius:6px;
			width:100%;
			padding:3px;
			font-family:Tahoma, sans-serif;
			font-size:12pt;
			display:inline-block;
			text-align:center;
			margin-top:10px;
		}
		.howToPlaySubtitle {
			font-family:'Roboto Slab', Tahoma, sans-serif;
			font-size:20pt;
			margin: 0px;
		}
		.howToPlaySubsection img {
			max-width:100%;
			display:inline-block;
			margin-top:10px;
		}
		.widthTest {
			font-family:'Roboto Slab', Tahoma, sans-serif;
			font-size:50pt;
			opacity:0;
			position:absolute;
			left:0px;
			top:0px;
			z-index:-2;
		}
		#playTableContainer {
			width:100%;
			display:inline-block;
			/*padding-left:30px;
			padding-right:30px;*/
		}
		#playTable {
			width:100%;
			border-collapse:collapse;
			table-layout:fixed;
		}
		.dealerLabel {
			display:none;
			font-weight:bold;
			position:relative;
			margin-bottom:-1.5em;
			margin-top:0px;
			height:1.5em;
			z-index:104;
		}
		.dealerLabel span {
			color:white;
			border:5px solid #ff0000;
			border-radius:5px;
			background-color:#ff0000;
		}
		/*#playTable tr, #playTable td {
			border:none;
		}*/
		.infoOnly {
			width:11%;
		}
		.playerCards {
			width:13%;
			padding-left:10px;
			padding-right:10px;
		}
		#centerCell .card {
			width:1.4em;
		}
		.endplayer .card {
			border-color:red;
			background-color:#ffdddd;
		}
		.card.showOutline {
			border:1px solid black;
		}
		.card {
			font-family:'Roboto Slab', Tahoma, sans-serif;
			border-radius:6px;
			background-color:white;
			font-size:24pt;
			font-weight:bolder;
			width:33%;
			text-align:center;
			line-height:87%;
			letter-spacing:-3;
			padding-right:3px;
			padding-top:0px;
			padding-bottom:5px;
			height:2.2em;
		}
		#playTable tr td {
			/*padding-bottom:8px;*/
		}
		.red {
			color:red;
		}
		.black {
			color:black;
		}
		.joker {
			color:black;
			letter-spacing:0;
			padding-right:0px;
			line-height:65%;
		}
		.jokerText {
			font-size:8pt;
		}
		.suit {
			width:100%;
			font-size:33pt;
		}
		.facedown {
			background-repeat:no-repeat;
			background-size:contain;
			background-position:center;
		}
		.facedown.deck1 {
			background-image:url('https://heldtraymond.github.io/Golf/cardBackBicycle.gif');
			background-color:#252760;
		}
		.facedown.deck2 {
			background-image:url('https://heldtraymond.github.io/Golf/cardBackDominos.gif');
			background-color:#000000;
		}
		.playerCell {
			font-style:bold;
		}
		.playerInfo {
			text-align:center;
		}
		.playerInfoWrapper {
			max-width:80px;
		}
		/*.cellComponent.endplayer {
			background-color:#ff0000;
		}*/
		.playerCards.live.current {
			background-color:blue;
		}
		.playerInfo.live.current {
			background-color:blue;
		}
		/*.playerInfo.live.current img {
			border-color:#8833bb;
		}
		.playerInfo.live.firstPlayer img {
			border-color:#8833bb;
		}*/
		.playerCards.current {
			background-color:#8833bb;
		}
		.playerInfo.current {
			background-color:#8833bb;
		}
		.playerInfo.live.firstPlayer img {
			border-color:#8833bb !important;
		}
		.playerInfo.firstPlayer img {
			border:5px solid #8833bb;
			margin:-2px -2px -2px -2px;
		}
		/*.playerInfo.current img {
			border:7px solid #8833bb;
			margin:-5px -5px -5px -5px;
		}*/
		/*.playerInfo.live {
			background-color:#77ff77;
		}*/
		.playerInfo.live:not(.current) img {
			border:8px solid blue;
			margin:-5px -5px -5px -5px;
		}
		.playerInfo img {
			background-color:white;
			border-radius:8px;
			border:3px solid black;
			max-height:100px;
			position:relative;
		}
		.playerName {
			margin-top:0px;
			margin-bottom:0px;
    		font-size:11pt;
			position:relative;
			z-index:100;
		}
		.endplayer .playerName span {
			background-color:#ffdddd;
			border-color:red;
		}
		.playerName span {
			color:black;
			border-radius:4px;
			background-color:#ccccff;
			border:2px solid #000088;
			padding-left:2px;
			padding-right:2px;
			display:inline-block;
			margin-top:-1.3em;
			margin-bottom:-1.3em;
			min-height:1.3em;
			min-width:1.3em;
		}
    	.playerCards table {
    		width:100%;
    		/*table-layout:fixed;*/
    	}
    	.card.discard {
    		background-color:#ff8888;
    		background-image:url('https://heldtraymond.github.io/Golf/discard.png');
			background-repeat:no-repeat;
			background-size:contain;
			background-position:center;
    	}
    	.card.discard:hover {
    		background-color:#ff0000 !important;
    	}
    	.card.selectedCard:hover {
    		background-color:#aaaaff !important;
    	}
    	.card.selectedCard {
    		background-color:#aaaaff !important;
    	}
    	@media (hover: none) {
			.playableCard.faceup:not(.discard):not(.selectedCard) {
				background-color:white !important;
			}
			.card.discard {
	    		background-color:#ff0000 !important;
			}
			#playerChoose img:not(.livePlayer):hover {
				margin:6px !important;
				border:3px solid white !important;
			}
			#playerChoose img.livePlayer:hover {
				border:8px solid #000099 !important;
				margin:1px !important;
			}
		}
    	.card.playableCard:hover {
    		cursor:pointer;
    		background-color:#66dd66;
    		/*border-color:green;*/
    	}
    	/*.playerCards.live .facedown:hover {
    		cursor:pointer;
    		background-color:#66dd66;
    		border-color:#ffff88;
    		background-image:none;
    	}*/
    	.card:hover {
    		cursor:not-allowed;
    	}
    	.playerInfo.right {
    		text-align:right;
    	}
    	.playerInfo.left {
    		text-align:left;
    	}
    	.playerInfoWrapper br {
			display:none;
    	}
    	#middleRow, #middleRow > td {
    		padding-top:5px;
    		padding-bottom:3px;
    	}
    	#leftCenterCell {
    		text-align:right;
    	}
    	#centerCell {
			font-size:12pt;
    		text-align:center;
    	}
    	#rightCenterCell {
    		text-align:left;
    	}
    	#leftCenterCell input {
    		margin-right:6px;
    		height:20px;
    		width:20px;
    	}
    	.toggleLabel, #leftCenterCell input {
    		vertical-align:middle;
    		cursor:pointer;
    	}
    	#toggleEnlargeCards {
    		background-color:#bbbbff;
    		display:inline-block;
    		width:90%;
    		padding:4px;
    		border: 2px solid #000066;
    		border-radius:7px;
    		display:center;
    		font-size:14pt;
    		font-family:Tahoma,sans-serif;
    		line-height:85%;
    	}
    	#leftCenterCell .centerInfo:hover {
    		cursor:pointer;
    		background-color:#bbbbff;
    		border:2px solid #000088;
    		border-radius:4px;
    		padding:0px 1px 2px 0px;
    	}
    	#leftCenterCell .centerInfo {
    		padding:2px 3px 4px 2px;
    	}
    	#leftCenterCell span {
    		width:100%;
    		display:inline-block;
    	}
    	#overlayContainer {
    		text-align:center;
    		width:100%;
    		position:absolute;
    		left:0;
    		z-index:120;
    		display:none;
    		top:0;
    	}
    	#overlayBackground {
    		width:100%;
    		position:absolute;
    		height:100%;
    		left:0;
    		background-color:black;
    		opacity:0.5;
    		z-index:-1;
    	}
    	.scoringSettings {
			padding:0px;
			margin:0px;
    	}
		.scoringSettings li {
			display: flex;
			padding-left:0px;
			margin-left:0px;
		}

		.scoringSettings li .cardType {
			order: 1;
		}

		.scoringSettings li .cardPoints {
			order: 3;
		}

		.scoringSettings li::after {
			content: "";
			border-bottom: 3px dotted;
			flex-grow: 1;
			order: 2;
			margin-bottom:0.4em;
			margin-left:0.1em;
			margin-right:0.1em;
		}

		#rulesStandings {
    		text-align:center;
    		display:inline-block;
    		border: 4px solid black;
    		border-radius:10px;
    		background-color:white;
    		padding:1em;
    		margin-top:1em;
    		position:relative;
    		max-width:830px;
		}

		.startSelectionScreen {
			font-family:'Roboto Slab', Tahoma, sans-serif;
    		text-align:center;
    		display:inline-block;
    		border-radius:10px;
    		border: 4px solid #006600;
    		padding:1em;
    		margin-top:1em;
    		position:relative;
		}

		#playerChoose {
    		background-color:#77cc77;
    		max-width:850px;
		}

		#deviceChoose {
			background-color:#ccccff;
			border-color:#000099;
			max-width:75%;
		}

		#deviceChoose h1 {
			margin-top:0px;
			margin-bottom:0px;
		}

		#deviceChoose table {
			table-layout:fixed;
		}

		#deviceChoose td {
			width:50%;
		}

		.deviceOption.selectedDevice {
			border:8px solid #000099 !important;
			margin:1px !important;
			background-color:#7777cc !important;
		}

		.deviceOption p {
			margin:0px;
			font-size:24pt;
		}

		.deviceOption:hover {
			cursor:pointer;
			border:6px solid #6666bb;
			margin:3px;
			background-color:#aaaaee;
		}

		.deviceOption {
			border:3px solid white;
			margin:6px;
			border-radius:10px;
			padding:10px 0px 10px 0px;
			text-align:center;
		}

		.deviceOption img {
			max-height:150px;
		}

		#deviceSelectDoneButton {
			margin-top:30px;
		}

		#playerChoose h1 {
			font-size:20pt;
			margin-top:0px;
			margin-bottom:0px;
		}
		#playerChoose h2 {
			margin-top:0px;
			font-size:14pt;
			font-family:'Roboto Slab', Tahoma, sans-serif;
		}

		#playerChoose img.livePlayer {
			border:8px solid #000099;
			margin:1px;
		}

		#playerChoose img.livePlayer:hover {
			border:8px solid #000099;
			margin:1px;
		}

		#playerChoose img:hover {
			border:6px solid #6666bb;
			margin:3px;
		}

		#playerChoose img {
			height:130px;
			margin:6px;
			border:3px solid white;
			border-radius:15px;
			cursor:pointer;
		}

    	#scoringRules {
    		text-align:left;
    		width:13em;
    		display:inline-block;
    		padding:1em 2em 1em 2em;
    		font-family:'Times New Roman';
    		font-size:22pt;
    		line-height:150%;
    	}

		#roundByRoundTable {
			font-family:'Roboto Slab', Tahoma, sans-serif;
    		font-size:18pt;
    		border-collapse:collapse;
    		display:inline-block;
		}

		#roundByRoundTable td {
			border-top:1px solid #006600;
			border-bottom:1px solid #006600;
		}

		#roundByRoundTable tr td:nth-child(1) {
			text-align:right;
			/*background-color:#88bb88 !important;*/
		}
		#roundByRoundTable tr th:nth-child(1) {
			text-align:right;
		}

		#roundByRoundTable tr td:nth-child(even) {
			background-color:#aaeeaa;
			color:#000000;
		}

		/*#roundByRoundTable tr td:nth-child(odd) {
			background-color:#eeaaaa;
			color:#000000;
		}*/

		#roundByRoundTable tr td:nth-child(2) {
			background-color:#006600;
			color:white !important;
			/*border-right:3px solid black !important;*/
		}

		#roundByRoundTable th, #roundByRoundTable td {
			padding:3px 7px 3px 7px;
			text-align:center;
			min-width:1em;
		}

		#roundByRoundTable th {
			background-color:#006600;
			color:white;
		}

		.buttonContainer {
			text-align:center;
		}

		.buttonContainer button {
			font-family:'Roboto Slab', Tahoma, sans-serif;
    		font-size:15pt;
    		padding:15px;
    		margin-top:10px;
    		border-radius:7px;
    		cursor:pointer;
		}

		.rulesStandingsButton:hover {
    		background-color:#6666ff;
		}
		.rulesStandingsButton.selected {
    		color:#9999ff;
    		background-color:#000066;
		}
		.rulesStandingsButton {
    		background-color:#bbbbff;
    		color:#000066;
    		margin-bottom:10px;
		}

		#scoringRulesButton {
			border-top-right-radius:0px;
			border-bottom-right-radius:0px;
			margin-right:-3px;
		}
		#howToPlayButton {
			border-top-left-radius:0px;
			border-bottom-left-radius:0px;
			margin-left:-3px;
			margin-right:-3px;
		}
		#standingsButton {
			border-top-left-radius:0px;
			border-bottom-left-radius:0px;
			margin-left:-3px;
		}

		.startRoundButton:hover {
    		background-color:#44bb44;
		}
		.startRoundButton {
    		background-color:#006600;
    		color:white;
		}

		.overlayCloseButton:hover {
			cursor:pointer;
			background-color:#bb44ff;
		}
		.overlayCloseButton {
    		background-color:#8833bb;
    		color:white;
    		font-size:15pt;
		}

		#rulesStandingsTopCloseButton {
			font-size:20pt;
			font-family:sans-serif;
			font-weight:bold;
			position:absolute;
			top:-20px;
			left:100%;
			margin-left:-30px;
			min-width:50px;
			min-height:50px;
			padding: 4px 13px 7px 13px;
			border:3px solid #440066;
			border-radius:25px;
		}

		.scoreImg {
			height: 1.2em;
			margin-right: 4px;
			margin-bottom:-0.2em;
		}

		#clipboard:hover {
			cursor:pointer;
			-webkit-filter: drop-shadow(0px 0px 30px #aa7744);
			filter: drop-shadow(0px 0px 30px #aa7744);
		}

		#clipboard {
			max-width:85%;
		}

		#playButton:hover {
    		background-color:#44bb44;
		}

		#playButton {
			background-color:#006600;
			color:white;
			font-size:30pt;
			padding-top:5px;
			padding-bottom:5px;
		}

		#mainHowToPlayButton:hover {
    		background-color:#88ff88;
		}

		#mainHowToPlayButton {
			background-color:#ffffff;
			color:#006600;
			font-size:18pt;
			padding-top:5px;
			padding-bottom:5px;
		}

		#playButtonContainer {
			position:relative;
			text-align:center;
			width:100%;
			left:0;
			top:0;
		}

		</style>
	<script src="jquery.js"></script>
</head>
<body style="overflow-y:scroll;text-align:center;">
	<span class="widthTest" id="widthTestValue">A</span>
	<span class="widthTest" id="widthTestSuit">♣</span>
	<img id="bgPhoto" src="https://heldtraymond.github.io/Golf/LivingRoomChristmas.jpg" style="width:100%;position:absolute;left:0px;top:0px;z-index:-1">
	<div id="playTableContainer">
		<table id="playTable">
			<tr>
				<td class="infoOnly"></td>
				<td></td>
				<td class="playerInfo cellComponent" id="playerInfo0">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo1">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo2">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo3">
				</td>
				<td></td>
				<td class="infoOnly"></td>
			</tr>
			<tr>
				<td class="playerInfo cellComponent right" id="playerInfo13">
				</td>
				<td class="playerCards cellComponent" id="playerCards13">
				</td>
				<td class="playerCards cellComponent" id="playerCards0">
				</td>
				<td class="playerCards cellComponent" id="playerCards1">
				</td>
				<td class="playerCards cellComponent" id="playerCards2">
				</td>
				<td class="playerCards cellComponent" id="playerCards3">
				</td>
				<td class="playerCards cellComponent" id="playerCards4">
				</td>
				<td class="playerInfo cellComponent left" id="playerInfo4">
				</td>
			</tr>
			<tr id="middleRow">
				<td class="playerInfo cellComponent right" id="playerInfo12">
				</td>
				<td class="playerCards cellComponent" id="playerCards12">
				</td>
				<td id="leftCenterCell">
					<span id='toggleNames' style="display:none" class="centerInfo"><label class='toggleLabel' for='toggleNamesBox'>Show names</label><input type='checkbox' id='toggleNamesBox' onclick='ToggleNames()' /></span>
					<span id='toggleScores' style="display:none" class="centerInfo"><label class='toggleLabel' for='toggleScoresBox'>Show scores</label><input type='checkbox' id='toggleScoresBox' onclick='ToggleScores()' /></span>
					<span id='fullScreen' style="display:none" class="centerInfo"><label class='toggleLabel' for='toggleFullScreenBox'>Full-Screen</label><input type='checkbox' id='toggleFullScreenBox' onclick='ToggleFullScreen()' /></span>
					<button id='toggleEnlargeCards' style="display:none" onclick="ToggleEnlargeCards()">
						<input type='checkbox' id='toggleEnlargeCardsBox' style="margin:0px 3px 0px 0px" />Enlarge my cards on my turn
					</button>
				</td>
				<td colspan="2" id="centerCell">
					<span id='centerCellInfoTop'></span>
					<table align='center' id='centerCellCards'>
						<tr>
							<td class='card' id='discardCard' onclick='ClickedDiscard()'></td>
							<td class='card' id='drawPileCard' onclick='ClickedDrawCard()'></td>
						</tr>
					</table>
					<span id='centerCellInfoBottom'></span>
				</td>
				<td id="rightCenterCell">
					<img id="clipboard" style="display:none" class="centerInfo alwaysClickable" src="https://heldtraymond.github.io/Golf/clipboard2.png" onclick="ShowRulesStandings()">
				</td>
				<td class="playerCards cellComponent" id="playerCards5">
				</td>
				<td class="playerInfo cellComponent left" id="playerInfo5">
				</td>
			</tr>
			<tr>
				<td class="playerInfo cellComponent right" id="playerInfo11">
				</td>
				<td class="playerCards cellComponent" id="playerCards11">
				</td>
				<td class="playerCards cellComponent" id="playerCards10">
				</td>
				<td class="playerCards cellComponent" id="playerCards9">
				</td>
				<td class="playerCards cellComponent" id="playerCards8">
				</td>
				<td class="playerCards cellComponent" id="playerCards7">
				</td>
				<td class="playerCards cellComponent" id="playerCards6">
				</td>
				<td class="playerInfo cellComponent left" id="playerInfo6">
				</td>
			</tr>
			<tr>
				<td class="infoOnly"></td>
				<td>
					<!--u style="color:blue;cursor:pointer;display:none" id="RefreshButton" onclick="ClickedRefresh()">Refresh</u-->
				</td>
				<td class="playerInfo cellComponent" id="playerInfo10">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo9">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo8">
				</td>
				<td class="playerInfo cellComponent" id="playerInfo7">
				</td>
				<td></td>
				<td class="infoOnly"></td>
			</tr>
		</table>
	</div>
	<div class="buttonContainer" id="playButtonContainer" style="display:none">
		<button id='playButton' onclick="ClickedPlayButton()">Play Golf!</button>
		<span id="continuePlaying">
			<span id="playingAs"></span><br>
			<span id="continuePlayingImages"></span><br>
			<button id='continuePlayingButton' onclick="ClickedContinuePlayingButton()">Resume</button><br>
			<button id='changePlayingButton' onclick="ClickedPlayButton()">Change Device/Player(s)</button>
		</span>
		<br>
		<button id='mainHowToPlayButton' onclick="ShowScoringRules()">Rules and How To Play</button>
	</div>
	<div id="overlayContainer">
		<div id="overlayBackground"></div>
		<span id="playerChoose" class="overlayContent startSelectionScreen">
			<h1>Who is playing on this device?</h1>
			<h2>(You can select multiple people)</h2>
			<div id="playerPhotos"></div>
			<div class="buttonContainer">
				<button class="overlayCloseButton" onclick="PlayerSelectDone()">Play</button>
			</div>
		</span>
		<span id="deviceChoose" class="overlayContent startSelectionScreen">
			<h1>What kind of device are you playing on?</h1>
			<table id="devices">
				<tr>
					<td>
						<div class="deviceOption" onclick="ClickedDevice(this)">
							<img src="https://heldtraymond.github.io/Golf/pc.png">
							<p>Laptop/Computer</p>
						</div>
					</td>
					<td>
						<div class="deviceOption" id="deviceOptionMobile" onclick="ClickedDevice(this)">
							<img src="https://heldtraymond.github.io/Golf/mobile.png">
							<p>Phone/Tablet</p>
						</div>
					</td>
				</tr>
				<tr>
					<td class="deviceDescription">Excellent choice!</td>
					<td class="deviceDescription">Turn your device horizontally to landscape for best results</td>
				</tr>
			</table>
			<div id="mobileDescription" style="display:none">On a mobile device, your cards will automatically display larger on your turn so you don't accidentally tap on the wrong one and say "Wait, I didn't mean to do that!"<br>(You can turn this option off if you don't like it)</div>
			<div class="buttonContainer">
				<button id="deviceSelectDoneButton" style="display:none" class="overlayCloseButton" onclick="DeviceSelectDone()">Continue</button>
			</div>
		</span>
		<span id="rulesStandings" class="overlayContent">
			<button class="overlayCloseButton" id="rulesStandingsTopCloseButton" title="Close" onclick="OverlayClose()">x</button>
			<div class="buttonContainer">
				<button id='scoringRulesButton' class="rulesStandingsButton selected" onclick="ShowScoringRules()">Scoring Rules</button>
				<button id='howToPlayButton' class="rulesStandingsButton" onclick="ShowHowToPlay()">How to Play</button>
				<button id='standingsButton' class="rulesStandingsButton" onclick="ShowRoundByRound()">Current Standings</button>
			</div>
			<div class='timeStatus'></div>
			<span id="howToPlay">
				<span class="howToPlayHalf">
					<span class="howToPlaySubsection" id="howToPlayFlip">
						<p class="howToPlaySubtitle">Flip over card</p>
						<span>To flip over one of your face-down cards, click on it.</span><br>
						<img src="https://heldtraymond.github.io/Golf/howToPlay/flip.png">
					</span>
					<span class="howToPlaySubsection" id="howToPlayTake">
						<p class="howToPlaySubtitle">Take the card in the middle</p>
						<span>To take the face-up card in the middle, (1) click on it so it gets highlighted in blue, and then (2) click on the card in your hand that you want to trade it for.</span>
						<img src="https://heldtraymond.github.io/Golf/howToPlay/take.png">
					</span>
				</span>
				<span class="howToPlayHalf">
					<span class="howToPlaySubsection" id="howToPlayDraw">
						<p class="howToPlaySubtitle">Draw a card</p>
						<span>To draw the top card from the face-down pile in the middle, (1) click on the draw card to flip it over, and then (2) if you want to keep it, click on the card in your hand that you want to trade it for.</span>
						<img src="https://heldtraymond.github.io/Golf/howToPlay/draw.png">
					</span>
					<span class="howToPlaySubsection" id="howToPlayDiscard">
						<p class="howToPlaySubtitle">Discard the draw card</p>
						<span>If you flipped over the draw card and decide you don't want it, click the red Discard button to get rid of it and end your turn.</span>
						<img src="https://heldtraymond.github.io/Golf/howToPlay/discard.png">
					</span>
				</span>
			</span>
			<span id="scoringRules">
				<u><i><strong>GOLF</strong></i></u>
				<ul class="scoringSettings">
				  <li>
				    <span class="cardType">Ace</span>
				    <span class="cardPoints"><strong>1</strong> point</span>
				  </li>
				  <li>
				    <span class="cardType">King</span>
				    <span class="cardPoints"><strong>0</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">Queen</span>
				    <span class="cardPoints"><strong>10</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">Jack</span>
				    <span class="cardPoints"><strong>20</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">Joker</span>
				    <span class="cardPoints"><strong>-3</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">All others</span>
				    <span class="cardPoints"><strong>face</strong> value</span>
				  </li>
				  <!--span style="font-size:8pt">(Ugh, I hate using Times New Roman. Thanks, Rousseau's...)</span-->
				  <br>
				  <li>
				    <span class="cardType">All 4 corners</span>
				    <span class="cardPoints"><strong>-20</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">4 next to each other</span>
				    <span class="cardPoints"><strong>-20</strong> points</span>
				  </li>
				  <li>
				    <span class="cardType">All 6</span>
				    <span class="cardPoints"><strong>-30</strong> points</span>
				  </li>
				</ul>
			</span>
			<table id="roundByRoundTable">
				<tr>
					<th>Player</th>
					<th>Total</th>
					<th>1</th>
					<th>2</th>
					<th>3</th>
					<th>4</th>
					<th>5</th>
					<th>6</th>
					<th>7</th>
					<th>8</th>
					<th>9</th>
				</tr>
			</table>
			<div class='timeStatus'></div>
			<div class="buttonContainer">
				<button class="overlayCloseButton" onclick="OverlayClose()">Close</button>
			</div>
		</span>
	</div>
</body>
<script>
	var DECK = [];
	var LIVE_PLAYERS = [];
	var NAMES = [
		"Nicole",
		"Samantha",
		"Justin",
		"Elizabeth",
		"Nicholas",
		"Lauren",
		"Michael",
		"Angela",
		"Ray",
		"Tracy",
		"Jeff",
		"David",
		"Michelle",
		"Diane",
	];

	var NICKNAMES = [
		"Nikki",
		"Sami",
		"Eagle scout",
		"Queen Elizabeth",
		"Buddy's 2nd favorite",
		"Ms. Straley",
		"El Jefe",
		"Miss Keller",
		"Ray",
		"Dave's sister",
		"Uncle Jeff",
		"Dave",
		"Buddy's favorite",
		"Bogie",
	];

	var ANGELA = [
		"Angela's cousin",
		"Angela's cousin",
		"Angela's cousin",
		"Angela's sister",
		"Angela's brother",
		"Angela's sister-in-law",
		"Angela's brother",
		"Angela",
		"Angela's boyfriend",
		"Angela's aunt",
		"Angela's uncle",
		"Angela's dad",
		"Angela's mom",
		"Angela's grandma",
	];

	var IS_TOUCHSCREEN = false;
	var ENLARGE_CARDS = false;
	var ROUND_NUM = 0;
	var DRAW_INDEX = 0;
	var DRAWING_TWO = false;
	var UPCARD_VAL = null;
	var DRAWCARD_VAL = null;
	var NEXTCARD_VAL = null;

	var DEBUG_MODE = false;

	var STATUS_INTERVAL = null;
	var CLOCK_INTERVAL = null;
	var COUNTDOWNEND_TIME = null;
	var COUNTDOWN_INTERVAL = null;

	var TOTAL_SEATS = 14;
	var SEATS = [];
	var DEALER = null;
	var CURRENT_SEAT = null;
	var START_SEAT = null;
	var END_SEAT = null;

	var IS_FULLSCREEN = false;

	var SUITS = ["♥", "♠", "♦", "♣"];
	var VALS = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

	var SHOW_SCORES = true; // (Math.random() > 0.5);	
	var SHOW_NAMES = true; //(Math.random() > 0.5);
	var PREV_SHOW_SCORES = SHOW_SCORES;

	var LAST_RESIZE = new Date();
	var LAST_WINDOW_SIZE = $("#bgPhoto").width();

	var GAME_DATA = null;
	var KEEP_FETCHING = true;
	var DEALING = false;

	var FETCH_COUNT = 0;
	var HAD_LIVE_ACTION_ALREADY = false;
	var IS_FIRST_FETCH = true;

	$("#standingsButton").hide();
	$("#centerCellCards").hide();

	setTimeout(OnPageLoad, 400);

	// Load the images now so they're ready to display when user clicks Play Golf!
	for (var i = 0; i < NAMES.length; i++) {
		var img = $("<img>");
		img.attr("nameIndex", i);
		img.attr("src", "https://heldtraymond.github.io/Golf/players/" + NAMES[i] + ".jpg");
		img.attr("onclick", "ClickedPlayer(this)");
		$("#playerPhotos").append(img);
	}

	$("body").animate({scrollTop:0},700);

	function OnPageLoad() {
		if (localStorage.getItem("GOLF_DATA") === null) {
			$("#continuePlaying").hide();
		}
		else {
			$("#playButton").hide();

			var GOLF_DATA = JSON.parse(localStorage.getItem("GOLF_DATA"));
			$("#playingAs").html("Playing on " + (GOLF_DATA.mobile ? "phone/tablet" : "computer/laptop"));

			for (var i = 0; i < GOLF_DATA.live.length; i++) {
				var playerIndex = GOLF_DATA.live[i];
				LIVE_PLAYERS.push(playerIndex);
				$("#continuePlayingImages").append("<img src='https://heldtraymond.github.io/Golf/players/" + NAMES[playerIndex] + ".jpg'>");
			}
		}
		ShowStartButtons();
	}

	function ShowStartButtons() {
		var photoHeight = $("#bgPhoto").height();
		$("#playButtonContainer").css("top", photoHeight * 0.35).fadeIn(300);
	}

	function GetLatestData() {
		PingServer(null, true);
	}

	function FetchDataWithoutRefresh() {
		PingServer(null, false);
	}

	function ClickedContinuePlayingButton() {
		var GOLF_DATA = JSON.parse(localStorage.getItem("GOLF_DATA"));
		IS_TOUCHSCREEN = GOLF_DATA.mobile;
		ENLARGE_CARDS = GOLF_DATA.enlarge;
		$("#toggleEnlargeCardsBox").prop("checked", ENLARGE_CARDS);
		if (IS_TOUCHSCREEN) {
			$("#toggleNames, #toggleScores, #fullScreen").remove();
		}
		else {
			$("#toggleEnlargeCards").remove();
		}

		ReadyToPlay();
	}

	function ClickedPlayButton() {
		$("#playButtonContainer").fadeOut(250);
		ShowDeviceSelection();
	}

	function ClickedDevice(el) {
		if ($(el).hasClass("selectedDevice")) {
			$(el).removeClass("selectedDevice");
		}
		else {
			$(".selectedDevice").removeClass("selectedDevice");
			$(el).addClass("selectedDevice");
		}

		$("#mobileDescription").toggle($("#deviceOptionMobile").hasClass("selectedDevice"));
		$("#deviceSelectDoneButton").toggle($(".selectedDevice").length > 0);
	}

	function DeviceSelectDone() {
		IS_TOUCHSCREEN = $("#deviceOptionMobile").hasClass("selectedDevice");
		if (IS_TOUCHSCREEN) {
			$("#playerChoose h2").hide();
			$(".howToPlaySubsection span").each(function() {
				$(this).html($(this).html().replace("click", "tap").replace("click", "tap"));
			});
			$(".howToPlaySubsection img").each(function() {
				var src = $(this).attr("src");
				$(this).attr("src", src.substring(0, src.length - 4) + "_mobile.png");
			});
			SHOW_SCORES = true;
			SHOW_NAMES = false;
			ENLARGE_CARDS = true;
			$("#toggleEnlargeCardsBox").prop("checked", true);
			$("#toggleNames, #toggleScores, #fullScreen").remove();
		}
		else {
			$("#toggleEnlargeCards").remove();
		}

		OverlayClose();
		setTimeout(ShowPlayerSelection, 500);
	}

	function ClickedPlayer(el) {
		if ($(el).hasClass("livePlayer")) {
			$(el).removeClass("livePlayer");
		}
		else {
			if (IS_TOUCHSCREEN) {
				$(".livePlayer").removeClass("livePlayer");
			}
			$(el).addClass("livePlayer");
		}
	}

	function PlayerSelectDone() {
		LIVE_PLAYERS = [];

		for (var i = 0; i < NAMES.length; i++) {
			if ($("#playerChoose img").eq(i).hasClass("livePlayer")) {
				LIVE_PLAYERS.push(i);
			}
		}

		var GOLF_DATA = {
			live: LIVE_PLAYERS,
			mobile: IS_TOUCHSCREEN,
			enlarge: IS_TOUCHSCREEN
		};

		localStorage.setItem("GOLF_DATA", JSON.stringify(GOLF_DATA));

		OverlayClose();
		ReadyToPlay();
	}

	function ReadyToPlay() {
		$("#playButtonContainer").fadeOut(250);
		Setup();
		$(".playerInfo, .card").css("opacity", 0);
		$("#centerCellCards").show();
		FitToWindow(true);
		$("#howToPlayButton").css("border-top-right-radius","0px").css("border-bottom-right-radius","0px");
		$("#standingsButton").show();
		$("#centerCell button").hide();
		var STATUS_INTERVAL = setInterval(CheckForStatus, 5000);

		GetLatestData();
	}

	function PingServer(pAction, pRefresh) {
		var params = {};
		if (pAction !== null) {
			params = {a:pAction};
		}

		if (DEBUG_MODE) {
			params.d = 1;
		}

		console.log(params);

        $.ajax({
            url:"processRequest.php",
            type: "post",
            dataType: 'json',
            data: params,
            success:function(result){
                console.log("SUCCESS");
                console.log(result);
                GAME_DATA = result;
                if (pRefresh) {
	                RenderLatestGameData();
                }
                else {
                	RefreshGameData();
                }
            },
            error:function(data) {
            	console.log("ERROR");
            	console.log(data);
            },
            complete:function() {
            	console.log("COMPLETE");
            }
        });
	}

	function DrawRoundByRound(pShow) {
		var PlayerScores = [];
		var anyScoresSoFar = false;
		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (SEATS[i] !== null) {
				var total = 0;
				for (var r = 0; r < SEATS[i].scores.length; r++) {
					total += SEATS[i].scores[r];
					anyScoresSoFar = true;
				}
				PlayerScores.push({
					name: ((ROUND_NUM === 4 && COUNTDOWNEND_TIME !== null) ? NICKNAMES[NAMES.indexOf(SEATS[i].name)] : SEATS[i].name),
					scores: SEATS[i].scores,
					total: total,
					isLive: SEATS[i].isLive
				});
			}
		}

		PlayerScores.sort(function(a, b) {
			return (a.total > b.total ? -1 : (a.total < b.total ? 1 : (a.name < b.name ? -1 : 1)));
		});

		var lastPlaceScore = (anyScoresSoFar ? PlayerScores[0].total : 7);

		$("#roundByRoundTable tr.playerScoringRow").remove();

		for (var i = 0; i < PlayerScores.length; i++) {
			var player = PlayerScores[i];
			var tr = $("<tr></tr>");
			tr.addClass("playerScoringRow");
			for (var c = 0; c < 11; c++) {
				var td = $("<td></td>");
				if (c === 0) {
					td.html((player.total >= lastPlaceScore ? "<img src='https://heldtraymond.github.io/Golf/trophy.png' class='scoreImg'>" : "") + player.name);
				} else if (c === 1) {
					td.html(player.total);
				} else {
					var round = c - 1;
					td.html(player.scores.length >= round ? player.scores[round - 1] : "");
				}
				//$(this).find("td").css("background-color", "");

				tr.append(td);
			}
			$("#roundByRoundTable").append(tr);
		};

		if (pShow === true) {
			ShowRoundByRound();
		}
	}

	function CheckForStatus() {
		FETCH_COUNT++;
		if (KEEP_FETCHING && (ROUND_NUM === null || ROUND_NUM > 0 || (FETCH_COUNT % 5 === 0))) {
			GetLatestData();
		}
	}

	function BeginCountdown() {
		if (typeof GAME_DATA.t === "undefined") { return; }

		COUNTDOWNEND_TIME = new Date((new Date()).getTime() + (1000 * GAME_DATA.t));
		COUNTDOWN_INTERVAL = setInterval(Countdown, 100);
	}

	function StopCountdown() {
		clearInterval(COUNTDOWN_INTERVAL);
		COUNTDOWN_INTERVAL = null;
		KEEP_FETCHING = true;
		$("#centerCellInfoTop, #centerCellInfoBottom, .timeStatus").html("");
	}

	function RefreshGameData() {
		if (typeof GAME_DATA.r !== "undefined") { ROUND_NUM = GAME_DATA.r; }
		if (typeof GAME_DATA.c !== "undefined") { CURRENT_SEAT = GAME_DATA.c; }
		if (typeof GAME_DATA.n !== "undefined") { NEXTCARD_VAL = GAME_DATA.n; }
		if (typeof GAME_DATA.u !== "undefined") { UPCARD_VAL = GAME_DATA.u; }
		if (typeof GAME_DATA.d !== "undefined") { DRAWCARD_VAL = GAME_DATA.d; }
		if (typeof GAME_DATA.f !== "undefined") { END_SEAT = GAME_DATA.f; }
		if (typeof GAME_DATA.s !== "undefined") {
			seatInfo = GAME_DATA.s;
			SEATS = [];
			for (var i = 0; i < TOTAL_SEATS; i++) {
				var seat = seatInfo[i];
				if (seat === null) {
					SEATS.push(null);
				}
				else {
					SEATS.push({
						playerId: seat.i,
						name: NAMES[seat.i],
						scores: seat.s,
						isLive: LIVE_PLAYERS.indexOf(seat.i) >= 0,
						cards: (seat.c === null || seat.c.length <= 0) ? [] : [seat.c[0], seat.c[1], seat.c[2], seat.c[3], seat.c[4], seat.c[5]]
					});
				}
			}
		}
	}

	function RenderLatestGameData() {
		setTimeout(RenderCurrentStatus, KEEP_FETCHING ? 220 : 150);

		if (typeof GAME_DATA.s !== "undefined" && !IS_FIRST_FETCH) {
			if (KEEP_FETCHING) {
				AnimateNewCards();
			}
			AnimateNewScores();
		}

		IS_FIRST_FETCH = false;
	}

	function RenderCurrentStatus() {
		var timeUntilNextRound = null;
		var seatInfo = null;
		var prevRound = ROUND_NUM;
		var prevSeat = CURRENT_SEAT;

		RefreshGameData();
		DrawPlayerInfos();

		if (typeof GAME_DATA.t !== "undefined") { timeUntilNextRound = GAME_DATA.t; }

		if (prevRound !== null && prevRound > 0 && ROUND_NUM !== null && (ROUND_NUM > prevRound || (ROUND_NUM === 9 && prevSeat !== null && CURRENT_SEAT === null))) {
			console.log(prevRound);
			console.log(ROUND_NUM);
			console.log(prevSeat);
			console.log(CURRENT_SEAT);
			// Round just ended - show standings
			setTimeout(ShowRoundByRound, 1300);
		}

		if (CURRENT_SEAT !== null) {
			KEEP_FETCHING = !(SEATS[CURRENT_SEAT].isLive);
		}

		if (ROUND_NUM <= 0 || (ROUND_NUM === 1 && timeUntilNextRound !== null && timeUntilNextRound > 70)) {
			MovePhotosToMiddle(false);
			$(".playerName").hide();
		}
		else {
			ShowHideNames();
		}

		$("#discardCard").toggle(UPCARD_VAL !== null).removeClass("discard").attr("title", "");
		$("#drawPileCard").toggle(DRAWCARD_VAL !== null);
		$(".current").removeClass("current");
		$(".playableCard").removeClass("playableCard");
		$(".endplayer").removeClass("endplayer");

		DrawRoundByRound(false);

		if (ROUND_NUM <= 0) {
			// Game hasn't started yet
			$("#centerCellInfoTop").html("Waiting for game to begin...");
			$("#centerCellInfoBottom").html("");
			KEEP_FETCHING = true;
			return;
		}

		if (!(ROUND_NUM <= 1 && timeUntilNextRound > 70)) {
			// Show all cards, unless waiting to start round 1
			$("#toggleNames, #toggleScores").show();
			RenderAllCards();
			var targetOpacity = (timeUntilNextRound > 70 || CURRENT_SEAT === null ? 0.5 : 1);
			$(".card").addClass("showOutline").css("opacity", targetOpacity);
			$(".playerName").stop().css("opacity", 1);
			ShowHideNames();
		}
		
		if (CURRENT_SEAT === null) {
			$("#centerCellInfoTop").html("Game over");
			$("#centerCellInfoBottom").html("");
			KEEP_FETCHING = false;
			return;
		}

		if (timeUntilNextRound > 70) {
			$("#centerCellInfoTop, .timeStatus").html("");
			if (COUNTDOWNEND_TIME === null) {
				BeginCountdown();
			}
			KEEP_FETCHING = false;
			return;
		}

		if (timeUntilNextRound !== null && timeUntilNextRound <= 70) {
			$("#centerCellInfoTop").html("Round " + ROUND_NUM);

			if (COUNTDOWNEND_TIME === null) {
				BeginCountdown();
			}

			for (var i = 0; i < SEATS.length; i++) {
				if (SEATS[i] === null || SEATS[i].isLive === false) continue;

				var cards = SEATS[i].cards;
				var numFaceUp = 0;

				for (var c = 0; c < 6; c++) {
					if (cards[c] > 0) {
						numFaceUp++;
					}
				}

				if (numFaceUp < 2) {
					$("#playerCards" + i + " .card.facedown").addClass("playableCard");
				}
			}

			$("#playerInfo" + CURRENT_SEAT).addClass("firstPlayer");
			$("#playerCards" + CURRENT_SEAT).addClass("firstPlayer");
			KEEP_FETCHING = true;

			CheckForEnlarged();
			return;
		}

		// Live hand playing
		$(".firstPlayer").removeClass("firstPlayer");
		if (COUNTDOWNEND_TIME !== null) {
			COUNTDOWNEND_TIME = null;
			StopCountdown();
		}
		$("#centerCellInfoTop").html("Round " + ROUND_NUM + " of 9");
		$("#centerCellInfoBottom").html(SEATS[CURRENT_SEAT].name + "'s turn");
		$("#playerInfo" + CURRENT_SEAT + ", #playerCards" + CURRENT_SEAT).addClass("current");

		if (DRAWCARD_VAL > 0) {
			if (SEATS[CURRENT_SEAT].isLive) {
				$("#discardCard").addClass("discard").html("").attr("title", "Discard");
			}
			else {
				$("#discardCard").css("opacity", 0.2);
			}
			$("#discardCard").css("opacity", ((DRAWCARD_VAL > 0 && SEATS[CURRENT_SEAT].isLive === false) ? 0.5 : 1));
		}
		else {
			$("#discardCard").css("opacity", 1);
		}

		if (END_SEAT !== null) {
			var redSeat = END_SEAT;

			while (redSeat !== CURRENT_SEAT) {
				$("#playerInfo" + redSeat).addClass("endplayer");
				$("#playerCards" + redSeat).addClass("endplayer");

				redSeat = GetAdjacentSeat(redSeat, 1);
			}
		}

		if (SEATS[CURRENT_SEAT].isLive) {
			// Set playable cards
			$("#playerCards" + CURRENT_SEAT + " .facedown").addClass("playableCard");
			$("#discardCard").addClass("playableCard");
			if (DRAWCARD_VAL < 0) {
				$("#drawPileCard").addClass("playableCard");
			}

			if (DRAWCARD_VAL > 0 || $("#discardCard").hasClass("selectedCard")) {
				$("#playerCards" + CURRENT_SEAT + " .card").addClass("playableCard");
			}
		}

		CheckForEnlarged();
	}

	function CheckForEnlarged() {
		if ($(".enlarged").length <= 0 && $(".playableCard").length > 0 && ENLARGE_CARDS === true) {
			ZoomInPlayableCards();
		}
		else if ($(".enlarged").length > 0 && $(".playableCard").length <= 0) {
			ZoomOutPlayableCards();
		}
	}

	function AnimateNewScores() {
		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (SEATS[i] === null || GAME_DATA.s[i] === null) continue;

			var scores = SEATS[i].scores;
			var newScores = GAME_DATA.s[i].s;

			if (newScores.length > scores.length && (SHOW_SCORES || SHOW_NAMES)) {
				$("#playerInfo" + i + " .playerName").animate({"opacity": 0}, 200);
			}
		}
	}

	function AnimateNewCards() {
		var changedCards = [];
		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (SEATS[i] === null || GAME_DATA.s[i] === null) continue;

			var cards = SEATS[i].cards;
			var newCards = GAME_DATA.s[i].c;

			for (var c = 0; c < 6; c++) {
				if ((cards === null && newCards !== null) || (cards !== null && cards[c] !== newCards[c])) {
					if (cards === null) {
						SEATS[i].cards = [];
						$("#playerCards" + i).css("opacity", 1);
					}
					SEATS[i].cards[c] = newCards[c];
					changedCards.push({
						el: $("#playerCards" + i + " .card").eq(c),
						val: newCards[c]
					});
				}
			}
		}

		if (GAME_DATA.d !== DRAWCARD_VAL) {
			DRAWCARD_VAL = GAME_DATA.d;
			changedCards.push({
				el: $("#drawPileCard"),
				val: DRAWCARD_VAL
			});
		}
		
		if (GAME_DATA.u !== UPCARD_VAL) {
			UPCARD_VAL = GAME_DATA.u;
			changedCards.push({
				el: $("#discardCard"),
				val: UPCARD_VAL
			});
		}

		for (var i = 0; i < changedCards.length; i++) {
			changedCards[i].el.animate({"opacity": 0}, 200);
/*			if (changedCards.length <= 5) {
				 {
					//RenderCard($(this), changedCards[i].val);
					$(this).fadeIn(200);
				});
			}
			else {
				RenderCard(changedCards[i].el, changedCards[i].val);
			}*/
		}
	}

	function Setup() {
		if (!IS_TOUCHSCREEN) {
			$(window).resize(SafeFitToWindow);
		}

		$("#toggleScoresBox").prop("checked", SHOW_SCORES);
		$("#toggleNamesBox").prop("checked", SHOW_NAMES);
		$("#toggleEnlargeCardsBox").prop("checked", ENLARGE_CARDS);

		//$(".centerInfo").hide();

		$(".playerInfo").each(function() {
			var span = $("<span></span>");
			span.addClass("playerInfoWrapper");
			var name = $("<p><span></span></p>");
			name.addClass("playerName");
			var img = $("<img>");
			img.attr("src", "https://heldtraymond.github.io/Golf/User.png");
			img.css("height","100px");
			img.css("width","100px");
			img.css("background-color", "white");
			var dealer = $("<p><span>DEALER</span></p>");
			dealer.addClass("dealerLabel");
			var id = parseInt($(this).attr("id").substring(10));
			if (id >= 40 && id <= 3) {
				span.append(name);
				span.append(img);
				span.append(dealer);
			}
			else {
				span.append(img);
				span.append(dealer);
				span.append(name);
			}
			$(this).append(span);
		});
		$(".playerCards").each(function() {
			var id = parseInt($(this).attr("id").substring(11));
			var table = $("<table></table>");
			for (var r = 0; r < 2; r++) {
				var tr = $("<tr></tr>");
				for (var c = 0; c < 3; c++) {
					var td = $("<td></td>");
					td.addClass("card");
					td.attr("seatNum", id);
					td.attr("cardNum", (r * 3 + c));
					//if (id === livePlayer) {
						td.attr("onclick", "ClickedCard(this," + id + "," + (r * 3 + c) + ")");
					//}
					tr.append(td);
				}
				table.append(tr);
			}
			$(this).append(table);
		});

		$("#playerCards0, #playerCards1, #playerCards2, #playerCards3, #playerInfo7, #playerInfo8, #playerInfo9, #playerInfo10").css("border-radius","0px 0px 9px 9px");
		$("#playerCards7, #playerCards8, #playerCards9, #playerCards10, #playerInfo0, #playerInfo1, #playerInfo2, #playerInfo3").css("border-radius","9px 9px 0px 0px");
		$("#playerCards11, #playerCards12, #playerCards13, #playerInfo4, #playerInfo5, #playerInfo6").css("border-radius","0px 9px 9px 0px");
		$("#playerCards4, #playerCards5, #playerCards6, #playerInfo11, #playerInfo12, #playerInfo13").css("border-radius","9px 0px 0px 9px");

		$(".playerName").hide();
		$(".card").removeClass("showOutline");

		setTimeout(function() {
			$("#clipboard, #RefreshButton").fadeIn(300);

			if (IS_TOUCHSCREEN) {
				$("#toggleEnlargeCards").fadeIn(300);
			}
			else {
				$("#fullScreen").fadeIn(300);
			}
		}, 1000);
	}

	function MovePhotosToMiddle(pAnimate) {
		if (pAnimate) {
			$("#playerInfo11, #playerInfo12, #playerInfo13").find("img, .dealerLabel").animate({left:"125px", top: "11px"}, 1200);
			$("#playerInfo4, #playerInfo5, #playerInfo6").find("img, .dealerLabel").animate({left:"-123px", top: "11px"}, 1200);
			$("#playerInfo0, #playerInfo1, #playerInfo2, #playerInfo3").find("img, .dealerLabel").animate({top: "100px"}, 1200);
			$("#playerInfo7, #playerInfo8, #playerInfo9, #playerInfo10").find("img, .dealerLabel").animate({top: "-80px"}, 1200);
		}
		else {
			$("#playerInfo11, #playerInfo12, #playerInfo13").find("img, .dealerLabel").css("left", "125px").css("top", "11px");
			$("#playerInfo4, #playerInfo5, #playerInfo6").find("img, .dealerLabel").css("left", "-123px").css("top", "11px");
			$("#playerInfo0, #playerInfo1, #playerInfo2, #playerInfo3").find("img, .dealerLabel").css("top", "100px");
			$("#playerInfo7, #playerInfo8, #playerInfo9, #playerInfo10").find("img, .dealerLabel").css("top", "-80px");
		}
	}

	function DrawPlayerInfos() {
		$(".playerInfo.live").removeClass("live");
		$(".playerCards.live").removeClass("live");

		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (SEATS[i] === null) {
				//$("#playerInfo" + i + " img").hide();
				$("#playerInfo" + i + " .playerName").hide();
				//$("#playerCards" + i + " table").hide();
				$("#playerInfo" + i).css("opacity", 0);
				$("#playerCards" + i).css("opacity", 0);
			}
			else {
				$("#playerInfo" + i + " img").show();
				//$("#playerInfo" + i + " .playerName").show();
				$("#playerCards" + i + " table").show();
				$("#playerInfo" + i).css("opacity", 1);
				$("#playerCards" + i).css("opacity", 1);

				if (SEATS[i].isLive) {
					$("#playerInfo" + i).addClass("live");
					$("#playerCards" + i).addClass("live");
				}
				$("#playerInfo" + i + " img").attr("src", "https://heldtraymond.github.io/Golf/players/" + SEATS[i].name + ".jpg").css("height", "").css("width", "").css("background-color", "");
			}
		}
	}

	function OverlayClose() {
		HideOverlay();
	}

	function GetAdjacentSeat(pSeatNum, pDifference) {
		var newSeatNum = (pSeatNum + pDifference) % TOTAL_SEATS;
		if (newSeatNum < 0) {
			newSeatNum += TOTAL_SEATS;
		}

		while (SEATS[newSeatNum] === null) {
			newSeatNum = (newSeatNum + pDifference) % TOTAL_SEATS;
			if (newSeatNum < 0) {
				newSeatNum += TOTAL_SEATS;
			}
		}

		return newSeatNum;
	}

	function AnimateDealing() {
		var dealerSeat = GetAdjacentSeat(CURRENT_SEAT, -1);
		$(".playerCards").css("opacity", 1);

		setTimeout(function() {
			FitToWindow(true);
		}, 500);

		$(".playerName").hide();
		$("#leftCenterCell .centerInfo").not("#fullScreen").hide();

		$.when($(".card").animate({opacity: 0}, 400)).then(function() {
			$(".card").removeClass("showOutline");
		});

		MovePhotosToMiddle(true);

		$("#centerCellInfoTop").html("Round " + ROUND_NUM + " of 9");

		setTimeout(function() {
			$("#playerInfo" + dealerSeat + " img").css("border", "10px solid #ff0000").css("margin", "-7px -7px -7px -7px");
			$("#playerInfo" + dealerSeat + " .dealerLabel").show();
		setTimeout(function() {
			$(".playerInfoWrapper img").css("border", "").css("margin", "");
		setTimeout(function() {
			$("#playerInfo" + dealerSeat + " img").css("border", "10px solid #ff0000").css("margin", "-7px -7px -7px -7px");
		setTimeout(function() {
			$(".playerInfoWrapper img").css("border", "").css("margin", "");
		setTimeout(function() {
			$("#playerInfo" + dealerSeat + " img").css("border", "10px solid #ff0000").css("margin", "-7px -7px -7px -7px");
		setTimeout(function() {
			$(".playerInfoWrapper img").css("border", "").css("margin", "");
		setTimeout(function() {
			$("#playerInfo" + dealerSeat + " img").css("border", "10px solid #ff0000").css("margin", "-7px -7px -7px -7px");
			FetchDataWithoutRefresh();
		setTimeout(function() {
			$(".playerInfoWrapper img, .dealerLabel").animate({
		    	left:'0px',
		    	top:'0px',
			}, 1500);
			setTimeout(function() {
				//ShowHideNames();

				var delayTime = 0;
				var totalCards = 0;
				var totalPlayers = 0;

				for (var i = 0; i < SEATS.length; i++) {
					if (SEATS[i] === null) {
						continue;
					}

					var info = $("#playerInfo" + i);
					info.removeClass("current");
					var cards = $("#playerCards" + i);

					for (var c = 0; c < 6; c++) {
						var td = cards.find("td").eq(c);
						if (SEATS[i].cards.length > c) {
							RenderCard(td, -Math.abs(SEATS[i].cards[c]));
						}
					}

					totalPlayers++;
				}

				var currentSeat = CURRENT_SEAT;

				for (var q = 0; q < 6; q++) {
					for (var p = 0; p < SEATS.length; p++) {
						if (SEATS[p] === null) {
							continue;
						}

						var delay = (totalCards <= 3 ? 400 : (totalCards < totalPlayers ? 60 : 30));
						delayTime += delay;
						totalCards++;
						DealCard($("#playerCards" + currentSeat + " .card").eq(q), delayTime);

						if (totalCards < (6 * totalPlayers)) {
							currentSeat = GetAdjacentSeat(currentSeat, 1);
						}
					}
				}

				setTimeout(function() {
					$("#leftCenterCell .centerInfo").show();
					$(".playerName").css("opacity", "1");
					$(".playerInfoWrapper img").css("border", "").css("margin", "");
					$("#playerInfo" + dealerSeat + " .dealerLabel").hide();
					$("#centerCell .card").addClass("showOutline");
					ShowHideNames();
					KEEP_FETCHING = true;
					DEALING = false;
					GetLatestData();
				}, delayTime + 1000);
	  		}, 1500);
		}, 700);
		}, 100);
		}, 100);
		}, 100);
		}, 100);
		}, 100);
		}, 100);
		}, (ROUND_NUM <= 1 ? 450 : 2000));
	}

	function ZoomInPlayableCards() {
		var zoomSeats = [];
		for (var i = 0; i < TOTAL_SEATS; i++) {
			if (SEATS[i] != null && SEATS[i].isLive) {
				zoomSeats.push(i);
			}
		}

		if (GAME_DATA.t === null || GAME_DATA.t < 0) {
			// Live hand - need to enlarge the center cards also
			$("#centerCell .card").addClass("enlarged");
		}

		var sameSeatColumns = [
			[11,12,13],
			[0,10],
			[1,9],
			[2,8],
			[3,7],
			[4,5,6]
		];

		var lastZoomSeat = 13;

		for (var i = 0; i < zoomSeats.length; i++) {
			lastZoomSeat = zoomSeats[i];
			$("#playerCards" + zoomSeats[i]).addClass("enlargedPlayer");
			$("#playerCards" + zoomSeats[i] + " .card").addClass("enlarged");

			for (var c = 0; c < sameSeatColumns.length; c++) {
				var col = sameSeatColumns[c]
				if (col.indexOf(zoomSeats[i]) >= 0) {
					for (var s = 0; s < col.length; s++) {
						if (col[s] === zoomSeats[i]) continue;
						$("#playerCards" + col[s]).addClass("sameColAsEnlarged");
					}
				}
			}
		}

		$("#playTable").css("table-layout", "auto");
		$(".playerCards").not(".enlargedPlayer").not("sameColAsEnlarged").css({
			"width":"10%",
			"padding-left":"4px",
			"padding-right":"4px"
		});
		$(".playerCards.sameColAsEnlarged").not(".enlargedPlayer").css({
			"width":"10%",
			"padding-left":"9%",
			"padding-right":"9%"
		});
		$(".enlargedPlayer").animate({
			"width":"28%",
		}, 100);
		$(".enlarged").animate({
			"height":"100px",
			"width":"75px",
		}, 200);

		var drawCardTop = $("#centerCell").position().top;
		var playerCardTop = $("#playerCards" + lastZoomSeat).position().top;
		var scrollTo = (drawCardTop < playerCardTop && GAME_DATA.t === null ? drawCardTop : playerCardTop);
		var extraMargin = (CURRENT_SEAT <= 3 ? 80 : 10);
		$("body").animate({scrollTop: scrollTo - extraMargin}, 600);
		ResizeCards();
	}

	function ZoomOutPlayableCards() {
		$("#playTable").css("table-layout", "fixed");
		$(".playerCards").not(".enlargedPlayer").css({
			"width":"13%",
			"padding-left":"10px",
			"padding-right":"10px"
		});
		$(".enlargedPlayer").animate({
			"width":"13%",
		}, 200);

		$(".enlargedPlayer").removeClass("enlargedPlayer");
		$(".sameColAsEnlarged").removeClass("sameColAsEnlarged");
		$(".playerCards .enlarged").animate({
			height:"2.2em",
			width:"33%"
		}, 200);
		$(".playerCards .enlarged").removeClass("enlarged");
		$("#centerCell .card").removeClass("enlarged");
		$("#centerCell .card").animate({
			height:"2.2em",
			width:"1.4em"
		}, 200);

		setTimeout(function() {
			FitToWindow(true);
		}, 410);
	}

	function Countdown() {
		var current = new Date();
		if (current >= COUNTDOWNEND_TIME) {
			StopCountdown();
			GetLatestData();
			return;
		}
		else {
			timeDiff = (COUNTDOWNEND_TIME - current);
			var totalSeconds = Math.floor(timeDiff / 1000);

			var drawingTwo = false;
			if (totalSeconds < 70) {
				drawingTwo = true;

				if (!KEEP_FETCHING && !DEALING && totalSeconds > 62) {
					DEALING = true;
					AnimateDealing();
				}
			}
			else {
				// Counting down to the time when the cards get dealt
				totalSeconds -= 70;
			}

			var minutes = Math.floor(totalSeconds / 60);
			var seconds = totalSeconds % 60;
			var timeString = ("" + minutes + ":" + (seconds < 10 ? "0" : "") + seconds);

			if (drawingTwo) {
				$("#centerCellInfoTop").html(DEALING ? "" : ("Round " + ROUND_NUM));
				$("#centerCellInfoBottom").html(DEALING ? "" : (timeString + " remaining to<br>flip over 2 cards"));
				$(".timeStatus").html(DEALING ? "" : (timeString + " remaining to flip over 2 cards"));
			}
			else {
				$("#centerCellInfoTop, .timeStatus").html("Round " + ROUND_NUM + " begins in " + timeString);
				$("#centerCellInfoBottom").html("(" + SEATS[GetAdjacentSeat(GAME_DATA.c, -1)].name + " will be dealer)");
			}
		}
	}

	function RenderAllCards() {
		$(".card").stop();

		for (var i = 0; i < SEATS.length; i++) {
			if (SEATS[i] === null) {
				continue;
			}

			if (SEATS[i].cards === null || SEATS[i].cards.length <= 0) {
				$("#playerCards" + i + ".card").css("opacity", 0);
				continue;
			}
			else {
				$("#playerCards" + i + ".card").css("opacity", 1);
			}

			for (var c = 0; c < 6; c++) {
				RenderCard($("#playerCards" + i + " .card").eq(c), SEATS[i].cards[c]);
			}
		}

		if (UPCARD_VAL !== null) { RenderCard($("#discardCard"), UPCARD_VAL); }
		if (DRAWCARD_VAL !== null) { RenderCard($("#drawPileCard"), DRAWCARD_VAL); }
	}

	function FlipOverCard(pSeatNum, pCardNum) {
		console.log(SEATS[pSeatNum].name + ": Flip over card #" + (pCardNum + 1));
		var cards = $("#playerCards" + pSeatNum);
		var card = cards.find(".card").eq(pCardNum);

		if (!card.hasClass("playableCard")) {
			return;
		}

		$(".playableCard").removeClass("playableCard");
		card.animate({"opacity": 0}, 200);

		PingServer((100 * SEATS[pSeatNum].playerId) + pCardNum, true);
	}

	function PlayDrawCard(pCardIndex) {
		if (SEATS[CURRENT_SEAT] === null || SEATS[CURRENT_SEAT].isLive === false) {
			return;
		}

		var card = $("#discardCard");

		if (pCardIndex <= 5) {
			card = $("#playerCards" + CURRENT_SEAT + " .card").eq(pCardIndex);
		}

		if (!card.hasClass("playableCard")) {
			return;
		}

		$(".playableCard").removeClass("playableCard");
		$("#drawPileCard, #discardCard").add(card).animate({"opacity": 0}, 200);

		PingServer((100 * SEATS[CURRENT_SEAT].playerId) + (pCardIndex <= 5 ? (10 + pCardIndex) : 7), true);
	}

	function TakeDiscard(pCardIndex) {
		if (SEATS[CURRENT_SEAT] === null || SEATS[CURRENT_SEAT].isLive === false || pCardIndex > 5 || pCardIndex < 0) {
			return;
		}

		var card = $("#playerCards" + CURRENT_SEAT + " .card").eq(pCardIndex);
		if (!card.hasClass("playableCard")) {
			return;
		}

		$(".playableCard").removeClass("playableCard");
		$(".selectedCard").removeClass("selectedCard");
		$("#discardCard").add(card).animate({"opacity": 0}, 200);

		PingServer((100 * SEATS[CURRENT_SEAT].playerId) + pCardIndex + 10, true);
	}

	function FlipDrawCard(pIsLivePlayer) {
		if (SEATS[CURRENT_SEAT] === null || SEATS[CURRENT_SEAT].isLive === false || DRAWCARD_VAL > 0 || DRAWCARD_VAL === null || $("#discardCard").hasClass("selectedCard")) {
			return;
		}

		$(".playableCard").removeClass("playableCard");
		$("#discardCard").css("opacity", 0.5);
		$("#drawPileCard").animate({"opacity": 0}, 200);

		PingServer((100 * SEATS[CURRENT_SEAT].playerId) + 6, true);
	}

	function ClickedDiscard() {
		if (SEATS[CURRENT_SEAT] === null || SEATS[CURRENT_SEAT].isLive === false) {
			return;
		}

		if ($("#discardCard").hasClass("playableCard")) {
			if (DRAWCARD_VAL > 0) {
				PlayDrawCard(6);
			}
			else if ($("#discardCard").hasClass("selectedCard")) {
				$("#discardCard").removeClass("selectedCard");
				$("#drawPileCard").addClass("playableCard").css("opacity", 1);
				$("#playerCards" + CURRENT_SEAT + " .card.faceup").removeClass("playableCard");
			}
			else {
				$("#discardCard").addClass("selectedCard");
				$("#drawPileCard").removeClass("playableCard").css("opacity", 0.15);
				$("#playerCards" + CURRENT_SEAT + " .card").addClass("playableCard");
			}
		}
	}

	function ClickedDrawCard() {
		if (SEATS[CURRENT_SEAT].isLive && $("#centerCell .card").eq(1).hasClass("playableCard")) {
			FlipDrawCard(true);
		}
	}

	function ClickedCard(pCardEl, pSeatNum, pCardNum) {
		if (!$(pCardEl).hasClass("playableCard")) {
			return;
		}

		if (GAME_DATA.t !== null && GAME_DATA.t > 0 && GAME_DATA.t < 70) {
			FlipOverCard(pSeatNum, pCardNum);
		}
		else if (SEATS[CURRENT_SEAT].isLive && pSeatNum === CURRENT_SEAT) {
			if (DRAWCARD_VAL > 0) {
				PlayDrawCard(pCardNum);
			}
			else if ($("#discardCard").hasClass("selectedCard")) {
				TakeDiscard(pCardNum);
			}
			else {
				FlipOverCard(pSeatNum, pCardNum);
			}
		}
	}

	function DealCard(card, delayTime) {
		setTimeout(function() {
			card.css("opacity", 1).addClass("showOutline");
		}, delayTime);
	}

	function ToggleNames() {
		SHOW_NAMES = !SHOW_NAMES;
		ShowHideNames();
	}

	function ToggleScores() {
		SHOW_SCORES = !SHOW_SCORES;
		ShowHideNames();
	}

	function ShowHideNames() {
		console.log("ShowHideNames");
		$(".playerName").toggle(SHOW_SCORES || SHOW_NAMES);

		for (var i = 0; i < SEATS.length; i++) {
			var label = $("#playerInfo" + i).find(".playerName span");
			if (SEATS[i] === null) {
				label.hide();
			}
			else {
				label.html(GetPlayerLabelText(i));
			}
		}
	}

	function GetPlayerLabelText(pSeatNum) {
		var roundScores = SEATS[pSeatNum].scores;
		var total = 0;
		for (var i = 0; i < roundScores.length; i++) {
			total += roundScores[i];
		}
		return (SHOW_NAMES ? SEATS[pSeatNum].name : "") + (SHOW_SCORES ? " <strong>" + total + "</strong>" : "");
	}

	function RenderCard(td, value) {
		td.attr("cardVal", value);
		td.removeClass("red").removeClass("black").removeClass("deck1").removeClass("deck2").removeClass("facedown").removeClass("faceup").removeClass("joker").attr("title", "");
		var isFaceDown = (value < 0);
		value = Math.abs(value);

		if (isFaceDown) {
			td.addClass("facedown").addClass(value === 1 ? "deck1" : "deck2");
			td.html("");
		}
		else {
			td.addClass("faceup");
			var cardVal = (value - 1) % 54;
			if (cardVal > 51) {
				td.addClass("joker");
				td.html("<span class='jokerText'>J<span style='color:red'>O</span>K<span style='color:red'>E</span>R</span><br><span style='color:black'>♠</span><span style='color:red'>♥</span><br><span style='color:red'>♦</span><span style='color:black'>♣</span>");
			}
			else {
				var suit = Math.floor(cardVal / 13);
				td.html("<span>" + VALS[cardVal % 13] + "</span><br>" + '<span class="suit">' + SUITS[suit] + '</span>')
				  .addClass(suit % 2 == 1 ? "black" : "red");
			}
		}

		ResizeCards();
	}

	function SafeFitToWindow() {
		FitToWindow(false);
	}

	function FitToWindow(pOnPageLoad) {
		var currWindowSize = $("#bgPhoto").width();;

		if (currWindowSize === LAST_WINDOW_SIZE && pOnPageLoad !== true) {
			return;
		}

		LAST_RESIZE = new Date();
		var currTime = LAST_RESIZE; 
		setTimeout(function() {
			if (currTime !== LAST_RESIZE) {
				return;
			}
			LAST_WINDOW_SIZE = $("#bgPhoto").width();
			ResizeText();
			var idealMiddle = 0.575;
			var tableHeight = $("#playTable").height();
			var imageHeight = $("#bgPhoto").height();
			var windowHeight = window.innerHeight;
			var percentHeight = (tableHeight / imageHeight);
			var marginTopPercent = idealMiddle - (percentHeight / 2);
			var marginTopPixels = marginTopPercent * imageHeight;

			if (tableHeight > imageHeight) {
				marginTopPixels = -($("#playTableContainer").position().top);
			}
			else if (marginTopPixels + tableHeight > imageHeight) {
				marginTopPixels = imageHeight - tableHeight - ($("#playTableContainer").position().top) - 2;
			}

			$("#playTableContainer").css("margin-top", marginTopPixels + "px");
			
			var ua = window.navigator.userAgent.toLowerCase();
	        if (ua.indexOf("trident") >= 0 || ua.indexOf("edge") >= 0) {
				$("#playTableContainer").css("max-height", "200px");
			}

			var scrollTo = marginTopPixels + tableHeight - windowHeight + 10;

			if (windowHeight > tableHeight) {
				scrollTo += ((windowHeight - tableHeight) / 2);
			} else if (tableHeight > imageHeight) {
				scrollTo = (tableHeight - windowHeight) / 2;
			}

            if (pOnPageLoad == true) {
	            $('body').animate({
	                scrollTop: scrollTo
		        }, 1500);
            }
            else {
                window.scroll(0, scrollTo);
            }

            FitOverlay();

		}, 100);
	}

	function ToggleEnlargeCards() {
		ENLARGE_CARDS = !ENLARGE_CARDS;
		$("#toggleEnlargeCardsBox").prop("checked", ENLARGE_CARDS);

		var playableCount = $(".playableCard").length;
		if (ENLARGE_CARDS && playableCount > 0) {
			ZoomInPlayableCards();
		}

		if (!ENLARGE_CARDS && playableCount > 0) {
			for (var i = 0; i < SEATS.length; i++) {
				if (SEATS[i] !== null && SEATS[i].isLive) {
					ZoomOutPlayableCards(i);
				}
			}
		}

		var GOLF_DATA = {
			live: LIVE_PLAYERS,
			mobile: IS_TOUCHSCREEN,
			enlarge: ENLARGE_CARDS
		};

		localStorage.setItem("GOLF_DATA", JSON.stringify(GOLF_DATA));

	}

	function ToggleFullScreen() {
	/*	var body = $("body")[0];
		if (body.requestFullscreen) {
			body.requestFullscreen();
		} else if (body.webkitRequestFullscreen) { // Safari 
			body.webkitRequestFullscreen();
		} else if (elem.msRequestFullscreen) { // IE11
			body.msRequestFullscreen();
		}*/

		if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {  // current working methods
			if (document.documentElement.requestFullscreen) {
				document.documentElement.requestFullscreen();
			} else if (document.body.msRequestFullscreen) {
				document.body.msRequestFullscreen();
			} else if (document.documentElement.msRequestFullscreen) {
				document.documentElement.msRequestFullscreen();
			} else if (document.documentElement.mozRequestFullScreen) {
				document.documentElement.mozRequestFullScreen();
			} else if (document.documentElement.webkitRequestFullscreen) {
				document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
			}
		} else {
			if (document.exitFullscreen) {
				document.exitFullscreen();
			} else if (document.msExitFullscreen) {
				document.msExitFullscreen();
			} else if (document.mozCancelFullScreen) {
				document.mozCancelFullScreen();
			} else if (document.webkitExitFullscreen) {
				document.webkitExitFullscreen();
			}
		}

		setTimeout(function() {
	  		FitToWindow(true);
		}, 100);
	}

	function IncrementCurrent(pHighlight) {
		//console.log("Incrementing");
		var started = true;
		while (started === true || SEATS[CURRENT_SEAT] === null) {
			started = false;
			CURRENT_SEAT += 1;
			CURRENT_SEAT %= TOTAL_SEATS;
		}
		//console.log("Done Incrementing");

		$(".current").removeClass("current");

		if (pHighlight) {
			$("#playerInfo" + CURRENT_SEAT).addClass("current");
			$("#playerCards" + CURRENT_SEAT).addClass("current");
		}
	}

	function ResizeText() {
		var idealWidth = 1270;
		var actualWidth = $("#bgPhoto").width();
		var scale = (actualWidth / idealWidth);

		if (scale > 1) {
			scale = 1;
		}

		var photoHeight = scale * 100;
		if (photoHeight > 100) {
			photoHeight = 100;
		}
		if (photoHeight < 50) {
			photoHeight = 50;
		}

		$(".playerInfo img").css("max-height", photoHeight + "px");
		$("#centerCell, .centerInfo").css((scale * 16 < 14 ? 14 : scale * 16) + "pt");
		$(".playerName").css((scale * 14 < 12 ? 12 : scale * 14) + "pt");
		//$("#roundByRoundTable").css("font-size", (scale * 18) + "pt");
		//$("#scoringRules").css("font-size", (scale * 22) + "pt");
		//$(".buttonContainer button").css("font-size", (scale * 16) + "pt");

		ResizeCards();
	}

	function ResizeCards() {
		var idealWidth = 1270;
		var actualWidth = $("#bgPhoto").width();
		var scale = (actualWidth / idealWidth);

		// Compensate for line thickness
		if (scale > 1) {
			scale *= 1.02;
		}
		else {
			scale /= 1.02;
		}

		var suitScale = $("#widthTestValue").width() / $("#widthTestSuit").width() * 1.25;

		// Card 24 pt
		// Suit (24 * scale) pt since different browsers render them different sizes
		// Joker 8 pt
		// Name 12 pt

		$(".card").css("font-size", (scale * 24) + "pt").css("padding-bottom", (scale * 5) + "px").css("border-radius", (scale * 6) + "px");
		$(".showOutline").css("border-width", (scale * 1.8) + "px");
		$(".jokerText").css("font-size", (scale * 8) + "pt");
		$(".suit").css("font-size", (scale * suitScale * 24) + "pt");
		$(".joker>span").not(".jokerText").css("font-size", (scale * suitScale * 12) + "pt");

		$(".enlarged").css("font-size", (scale * 42) + "pt");
		$(".enlarged .jokerText").css("font-size", (scale * 14) + "pt");
		$(".enlarged .suit").css("font-size", (scale * suitScale * 42) + "pt");
		$(".enlarged.joker>span").not(".jokerText").css("font-size", (scale * suitScale * 21) + "pt");
	}

	function ShowPlayerSelection() {
		$(".overlayContent").hide();
		$("#playerChoose").show();
		ShowOverlay();
	}

	function ShowDeviceSelection() {
		$(".overlayContent").hide();
		$("#deviceChoose").show();
		ShowOverlay();
	}

	function ShowRulesStandings() {
		if ($("#howToPlayButton").hasClass("selected")) {
			ShowHowToPlay();
		}
		else if ($("#scoringRulesButton").hasClass("selected")) {
			ShowScoringRules();
		}
		else {
			ShowRoundByRound();
		}
	}

	function ShowHowToPlay() {
		$(".overlayContent").hide();
		$("#rulesStandings").show();
		$("#howToPlay").show();
		$("#scoringRules").hide();
		$("#roundByRoundTable").hide();
		$("#howToPlayButton").addClass("selected");
		$("#scoringRulesButton").removeClass("selected");
		$("#standingsButton").removeClass("selected");
		ShowOverlay();
	}

	function ShowScoringRules() {
		$(".overlayContent").hide();
		$("#rulesStandings").show();
		$("#howToPlay").hide();
		$("#scoringRules").show();
		$("#roundByRoundTable").hide();
		$("#howToPlayButton").removeClass("selected");
		$("#scoringRulesButton").addClass("selected");
		$("#standingsButton").removeClass("selected");
		ShowOverlay();
	}

	function ShowRoundByRound() {
		$(".overlayContent").hide();
		$("#rulesStandings").show();
		$("#howToPlay").hide();
		$("#scoringRules").hide();
		$("#roundByRoundTable").show();
		$("#howToPlayButton").removeClass("selected");
		$("#scoringRulesButton").removeClass("selected");
		$("#standingsButton").addClass("selected");
		ShowOverlay();
	}

	function ShowOverlay() {
		setTimeout(function() {
			FitOverlay();
			var scrollTo = parseInt($(".overlayContent:visible").css("top")) - 5;
			var imageHeight = $("#bgPhoto").height();
			var windowHeight = window.innerHeight;
			if (scrollTo + windowHeight > imageHeight) {
				scrollTo = imageHeight - windowHeight;
			}
			if (scrollTo < 0) {
				scrollTo = 0;
			}

			$("body").animate({scrollTop: scrollTo}, 500);
		}, 100);
		$("#overlayContainer").fadeIn(500);		
	}

	function FitOverlay() {
		var imageHeight = $("#bgPhoto").height();
		var windowHeight = window.innerHeight;
		var contentHeight = $(".overlayContent:visible").outerHeight() + 20;
		var overlayHeight = (imageHeight > windowHeight ? imageHeight : windowHeight);
		var targetTop = window.scrollY;

//		console.log(targetTop);
//		console.log(contentHeight);
//		console.log(windowHeight);
//		console.log(overlayHeight);

		if (targetTop + contentHeight > overlayHeight) {
//			console.log("part 1");
			targetTop = overlayHeight - contentHeight;
		}
		if (targetTop < 0) {
//			console.log("part 2");
			targetTop = 0;
		}

		$(".overlayContent").css("top", targetTop + 5);
		$("#overlayContainer").css("height", "" + overlayHeight + "px");
	}

	function HideOverlay() {
		$("#overlayContainer").fadeOut(500);
		SafeFitToWindow();
	}

	function ClickedRefresh() {
		DEBUG_MODE = false;
		PingServer(null, true);
	}
</script>

</html>